# ジョブ実行対象サーバ除外ツール

## 1. 目的
JP1/AJSなどのジョブ管理システムや運用管理ツールで使用する定義ファイル（confやcsv）から、撤去済み・削除対象のサーバ情報を**自動的に除去**するためのツールです。
対象サーバ一覧から、手作業で削除対象行を探して消すリスクを排除し、定義ファイルの品質を保つことを目的としています。

## 2. 配布パッケージ
**以下のファイルはすべて同じフォルダに必要な「セット」です。**

| # | ファイル名 | 役割 | 説明 |
| :--- | :--- | :--- | :--- |
|1| **Filter-File.ps1** | メインスクリプト | 処理の本体です。削除リストの読み込みも含めてすべての処理を行います。単独では実行しません。 |
|2| **run_filter-UTF8noBOM.bat** | 実行用BAT | **このアイコンに元ファイルをドロップして実行します。** <br>設定：UTF-8 (BOMなし) / 改行コード LF |
|3| **delete_servers.txt** | 除外リスト<br>(サンプル) | **【利用者作成】** 削除したいサーバ名を記述するファイルです。<br>※同梱されているのはサンプルです。実行の都度、最新のリストを用意してください。 |
|4| **README.md** | 手順書 | 本ファイルです。 |
|5| **REFERENCE.md** | 技術詳細 | カスタマイズ方法やFAQ、トラブルシューティングです。 |
|6| **TEST_CASES.md** | テストケース解説 | テストケースの詳細な説明です。開発者向け。 |
|7| **TEST_REPORT.md** | テスト結果レポート | テスト実行結果のレポートです。開発者向け。 |

> **【注意】** 本ツールは `Filter-File.ps1` と `run_filter-UTF8noBOM.bat` の2ファイルのみで動作します。以前必要だった補助ファイル（`read_delete_list.ps1`、`create_temp_script.ps1`）は不要です。

## 3. 実行手順

### 手順1. 除外リストの準備
今回削除したいサーバ名を `delete_servers.txt` に記述して保存してください。
* 1行に1つのキーワードを記述します。
* コメント行（`#` で始まる行）や空行は無視されます。

### 手順2. ファイルのドロップ
処理したいファイル、またはフォルダを `run_filter-UTF8noBOM.bat` にドラッグ＆ドロップしてください。

### 手順3. 結果の確認
元ファイルと同じ場所に `output` フォルダが生成され、その中に処理済みファイルが出力されます。

* **成功時**: 黒い画面に「Success」と表示され、**5秒後に自動的に閉じます**。
    * 標準設定では、成功時にログファイルは自動削除されます。
* **警告/エラー時**: 黒い画面が一時停止（Pause）します。
    * 画面またはログファイルを確認してください。

> **【重要：安全装置について】**
> `output` フォルダ内に同名のファイルが既に存在する場合、上書き防止のため**そのファイルの処理はスキップ（警告）されます**。
> 再実行する場合は、`output` フォルダ内の古いファイルを削除してから実行してください。

## 4. 開発者向けドキュメント

本リポジトリには、開発者向けの追加ドキュメントが含まれています：

- **TEST_CASES.md**: テストケースの詳細な解説
  - 各テストケースの目的と検証内容
  - テスト実行方法
  - トラブルシューティング

- **TEST_REPORT.md**: テスト実行結果のレポート
  - 最新のテスト結果
  - 検証された機能の一覧
  - テスト実行コマンド

これらのドキュメントは、コードの動作確認やテストケースの追加時に参照してください。