# ジョブ実行対象サーバ除外ツール

## 1. 目的
JP1/AJSなどのジョブ管理システムや運用管理ツールで使用する定義ファイル（confやcsv）から、撤去済み・削除対象のサーバ情報を**自動的に除去**するためのツールです。
対象サーバ一覧から、手作業で削除対象行を探して消すリスクを排除し、定義ファイルの品質を保つことを目的としています。

## 2. 配布パッケージ
本ツールは、任意の場所にフォルダごと配置して使用してください。
**以下のファイルはすべて同じフォルダに必要な「セット」です。**

| # | ファイル名 | 役割 | 説明 |
| :--- | :--- | :--- | :--- |
|1| **Filter-File.ps1** | メインスクリプト | 処理の本体です。単独では実行しません。 |
|2| **run_filter-UTF8noBOM.bat** | 実行用BAT | **このアイコンに元ファイルをドロップして実行します。** <br>設定：UTF-8 (BOMなし) / 改行コード LF |
|3| **delete_servers.txt** | 除外リスト<br>(サンプル) | **【利用者作成】** 削除したいサーバ名を記述するファイルです。<br>※同梱されているのはサンプルです。実行の都度、最新のリストを用意してください。 |
|4| **README.md** | 手順書 | 本ファイルです。 |
|5| **REFERENCE.md** | 技術詳細 | カスタマイズ方法やFAQ、トラブルシューティングです。 |

## 3. 準備・配置
上記のファイル一式を、**必ず同じフォルダ内（同一階層）** に配置してください。
（例：デスクトップに「FilterTool」フォルダを作成し、その中にすべて入れる）

| 対象ファイル | 入手元 | 配置場所 | 備考 |
| :--- | :--- | :--- | :--- |
| **Filter-File.ps1** | 配布パッケージ#1 | 任意フォルダ | ファイル名変更不可 |
| **run_filter-UTF8noBOM.bat** | 配布パッケージ#2 | **上記PS1と同じ場所** | **実行時はこれを使用** |
| **delete_servers.txt** | 配布パッケージ#3<br>**利用者が更新** | **上記PS1と同じ場所** | ファイル名は固定 |

## 4. 実行手順

### 手順1. 除外リスト（delete_servers.txt）の準備
今回定義ファイルから削除したいサーバ名の一覧を、`delete_servers.txt` という名前で保存してください。
* **作成方法**: 複数のサーバ群（面）のリスト等から、今回除外すべきサーバ名を抽出・加工して作成してください。
* **記述形式**: 1行に1つのサーバ名（キーワード）を記述します。
* このリストにある文字列が含まれる行は、出力ファイルから行ごと削除されます。

### 手順2. ファイルのドロップ
処理したい構成定義ファイル（csv/conf/txt等）、またはフォルダを `run_filter-UTF8noBOM.bat` のアイコンにドラッグ＆ドロップしてください。
* 複数ファイルの同時ドロップも可能です。

### 手順3. 結果の確認
元ファイルと同じ場所に `output` フォルダが自動生成されます。
その中のファイルを確認し、対象のサーバ行が正しく消えているか確認してください。

* **成功時**: 黒い画面に「Success」と表示され、5秒後に自動的に閉じます。
* **警告/エラー時**: 黒い画面が一時停止します。内容を確認し、キーを押して閉じてください。

> **【重要：再実行時の注意】**
> `output` フォルダ内に既に同名のファイルが存在する場合、**安全のため処理はスキップ（無視）されます。**
> やり直す場合は、`output` フォルダ内の古いファイルを削除または移動してから再実行してください。

## 5. 技術詳細
詳細な仕様は **REFERENCE.md** を参照してください。