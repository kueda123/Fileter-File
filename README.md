# ジョブ実行対象サーバ除外ツール

## 1. 目的
サーバ名が並ぶ定義ファイルから、対象行を正確に除外することで作業ミスを物理的に防ぎます。

## 2. 配布パッケージ
本ツールは、任意の場所に配置可能です。
アイコンに元ファイルをドロップするので、デスクトップにPS1とBATファイルを配置してください。


| # | ファイル名 | 役割 | 説明 |
| :--- | :--- | :--- | :--- |
|1| **Filter-File.ps1** | PS1ファイル | BATファイルから元ファイルを受け取り、フィルターファイルを生成します。単独では実行できません。 |
|2| **run_filter-UTF8noBOM.bat** | BATファイル | 元ファイルをドロップ可能にします。PS1ファイルにファイルのフルパスで渡します。 |
|3| **read_delete_list.ps1** | 補助PS1ファイル | BATファイルから呼び出され、除外リストファイルを読み込んで配列形式に変換します。 |
|4| **create_temp_script.ps1** | 補助PS1ファイル | BATファイルから呼び出され、一時的なPowerShellスクリプトを生成します。 |
|5| **README.md** | 手順書 | 本ファイル（作業手順）です。 |
|6| **REFERENCE.md** | 技術詳細 | カスタマイズ方法やFAQを確認できます。 |

## 3. 配置
以下のファイルを、 **必ず同じフォルダ内（同一階層）** に配置してください。

| 対象ファイル | 入手元 | 配置場所 | 備考 |
| :--- | :--- | :--- | :--- |
| **Filter-File.ps1** | 配布パッケージ#1 | デスクトップ等任意の場所 | ファイル名固定 |
| **run_filter-*.bat** | 配布パッケージ#2 | **上記PS1と同じ場所** | **リネーム可能** |
| **read_delete_list.ps1** | 配布パッケージ#3 | **上記PS1と同じ場所** | ファイル名固定 |
| **create_temp_script.ps1** | 配布パッケージ#4 | **上記PS1と同じ場所** | ファイル名固定 |
| **delete_servers.txt** | 作業者が作成 | **上記PS1と同じ場所** | 除外リスト |

- BATファイルのアイコンは、ファイルをドロップすることで、フルパスを渡せます。
- 配置先が、デスクトップなら作業が容易になります。別の場所に配置するなら、事前にエクスプローラで、BATファイルのアイコンが見える状態にしてください。
- 「除外リスト」のファイル名は、BAT内で指定されています。
修正する場合は、BATファイルを、別名で保管してください。


## 4. 実行手順
1. **csv/confファイルかフォルダをBATファイルのアイコンにドロップする**
BATファイルをデスクトップ以外に配置した場合は、
エクスプローラーで、アイコンを表示した状態にしてください。

2. **フィルター済みファイルをoutputフォルダで確認する**
元ファイルと同階層の `output` フォルダ内に同名のファイルが生成されます。

3. **他にも元ファイルがあれば、#1に戻り繰り返し**

## 5. 技術詳細
カスタマイズには、 **REFERENCE.md** を参照してください。
BATファイル(配布パッケージ#2)をカスタマイズすることで、
除外リスト名の修正や、文字コードの指定、BOMの有無などを修正できます。
その際は、用途別の別名保管することを推奨します。